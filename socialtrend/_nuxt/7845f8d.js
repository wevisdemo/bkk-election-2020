(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{486:function(t,e,n){var content=n(506);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(43).default)("5b225bd7",content,!0,{sourceMap:!1})},505:function(t,e,n){"use strict";n(486)},506:function(t,e,n){var r=n(42)((function(i){return i[1]}));r.push([t.i,'.line-chart-race[data-v-0b5e88d3]{width:100%;height:100%;position:relative}.tooltip-wrapper[data-v-0b5e88d3]{position:absolute;top:50%;transform:translateY(-50%);z-index:10;transition:all .2s;pointer-events:none}.tooltip-wrapper .tooltip[data-v-0b5e88d3]{background:rgba(0,0,0,.8);border:1px solid hsla(0,0%,100%,.2);border-radius:5px;color:#fff;padding:18px;min-width:170px}.tooltip-wrapper .tooltip .title[data-v-0b5e88d3]{font-weight:700}.tooltip-wrapper .tooltip .description[data-v-0b5e88d3]{font-weight:400}.tooltip-wrapper .tooltip .data-list[data-v-0b5e88d3]{width:100%;display:flex;align-items:center;justify-content:space-between;margin-top:10px}svg[data-v-0b5e88d3]{width:100%;height:100%}svg[data-v-0b5e88d3]  .axis-group .text,svg[data-v-0b5e88d3]  .axis-group .tick text{font-family:"Anuphan";font-style:normal;font-weight:400;font-size:11px;fill:#fff}svg[data-v-0b5e88d3]  .axis-group .text.disable{opacity:0;visibility:hidden}svg[data-v-0b5e88d3]  .x-axis .domain{stroke:#fff}svg[data-v-0b5e88d3]  .x-axis .tick line{display:none}svg[data-v-0b5e88d3]  .x-axis .tick:first-of-type text{text-anchor:start}svg[data-v-0b5e88d3]  .x-axis .tick:last-of-type text{text-anchor:end}svg[data-v-0b5e88d3]  .y-axis .domain{display:none}svg[data-v-0b5e88d3]  .y-axis .tick text{text-anchor:start}svg[data-v-0b5e88d3]  .y-axis .tick line{stroke:#373746}svg[data-v-0b5e88d3]  .y-axis .tick .line-tick{stroke:#fff}svg .listening-rect[data-v-0b5e88d3]{cursor:pointer}text[data-v-0b5e88d3]{font-family:Prompt}.line-group[data-v-0b5e88d3]{transition:all .3s}.line-group.not-active[data-v-0b5e88d3]{opacity:.1}.checks[data-v-0b5e88d3]{cursor:pointer}.legend-wrapper[data-v-0b5e88d3]{margin-top:14px}.legend-wrapper .legend[data-v-0b5e88d3]{max-height:260px;display:flex;justify-content:center;align-items:center;flex-direction:column;flex-wrap:wrap;margin:0 -8px}.legend-wrapper .legend-group.not-active[data-v-0b5e88d3]{opacity:.3}.legend-wrapper .legend-group[data-v-0b5e88d3]{min-width:270px;cursor:default;padding:5px 8px;transition:all .3s}.legend-wrapper .legend-group>span[data-v-0b5e88d3]{max-width:100%;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;display:flex}.legend-wrapper .legend-group .circle[data-v-0b5e88d3]{flex:0 0 auto;width:25px;height:25px;border-radius:20px}.legend-wrapper .legend-group .label[data-v-0b5e88d3]{flex:1;padding:0 0 0 8px}.fade-enter-active[data-v-0b5e88d3],.fade-leave-active[data-v-0b5e88d3]{transition:opacity .2s}.fade-enter[data-v-0b5e88d3],.fade-leave-to[data-v-0b5e88d3]{opacity:0}',""]),r.locals={},t.exports=r},508:function(t,e,n){"use strict";n.r(e);n(31),n(26),n(56),n(57);var r=n(20),o=(n(504),n(44),n(502),n(22),n(30),n(503)),c=n.n(o),l=n(507),d=n(0),h=n.n(d),f=n(522),m=n.n(f);function v(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function y(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):v(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var x={props:{width:{type:Number,default:1e3},height:{type:Number,default:500},engagement_raw_data:{type:Array,default:function(){return[]}},engagement_candidates:{type:Array,default:function(){return[]}},color:{type:Function,default:function(){}},animate:{type:Boolean,default:!0},play_animation:{type:Boolean,default:!1},activeChart:{type:null,default:""},stackedBarChart:{type:Array,default:function(){return[]}},type:{type:String,default:"engagement"},duration:{type:Number,default:2e4},start_date:{type:String,default:""},xAxisStart:{type:String,default:""},xAxisEnd:{type:String,default:""}},data:function(){return{step:8,left_tooltip:0,point:0,hover:"",active:"",animate_finish:!1,animate_start:!1}},computed:{margin:function(){return{top:30,left:32,right:"mobiel"===this.$mq?22:30,bottom:30}},innerWidth:function(){return this.width-this.margin.left-this.margin.right},innerHeight:function(){return this.height-this.margin.top-this.margin.bottom},formatThousands:function(){return l.e(",")},date_list:function(){return c.a.map(this.engagement_raw_data,"date")},line:function(){var t=this;return l.f().x((function(e){return t.xScale(e.date)})).y((function(e){return t.yScale(e.count)}))},xScaleActiveDate:function(){return l.k().domain([this.margin.left,this.width-this.margin.right]).range(this.date_list)},xScale:function(){return l.j().domain(this.date_list).range([this.margin.left,this.width-this.margin.right])},xAxis:function(){var t=this,e=this.engagement_raw_data.length,n=l.a(this.xScale).tickFormat((function(e){var n=e;return"engagement"===t.type&&(n=h()(e).add(543,"years").format("DD MMM YY")),n})).ticks(e).tickSize(1).tickPadding(12);return"engagement"===this.type&&(n=n.tickValues(l.d(this.engagement_raw_data,(function(t){return t.date})))),n},yScale:function(){var t=l.g(this.engagement_raw_data,(function(t){return t.maximum.count}));return l.h().domain([0,t]).range([this.height-this.margin.bottom,this.margin.top]).nice()},yAxis:function(){var t=this,e=9,n=function(e){return t.formatkilo(e)};if("rank"===this.type){var r=this.engagement_candidates.length;e=r,n=function(t){return 0===t?"":r+1-t}}return l.b(this.yScale).tickFormat(n).ticks(e).tickSize(-this.innerWidth)},transitionPath:function(){return l.n().ease(l.c).duration(this.duration)},interaction:function(){return this.hover||this.active}},watch:{play_animation:{handler:function(t){var e=this;t&&this.animate&&this.$nextTick((function(){e.handleStartAnimation()}))},immediate:!0},animate_finish:function(t){t&&!this.animate_start&&this.setShowDotsEnd()},activeChart:function(t){this.active=t,this.onMouseMove(),this.updateAnimatePathLabel(t,800)}},mounted:function(){this.drawLineChart()},methods:{handleStartAnimation:function(){var t=this;setTimeout((function(){t.setAnimatePathLine(),t.updateAnimatePathLabel(t.xAxisEnd,t.duration)}),1e3)},formatkilo:function(t){return m()(t).format("0 a")},dateDisplay:function(t){return h()(t).add(543,"years").format("DD MMM YY")},dateFormat:function(t){return h()(t).format("yyyy-MM-DD")},drawLineChart:function(){var t=this,svg=l.m("svg");svg.select(".axis-group").append("g").attr("class","y-axis").attr("transform","translate(".concat(this.margin.left,", 0)")).call(this.yAxis).call((function(e){e.selectAll(".tick").append("line").attr("class","line-tick").attr("x2",7),e.selectAll(".tick text").style("text-anchor","start").attr("x",-t.margin.left)})),svg.select(".axis-group").append("g").attr("class","x-axis").attr("transform","translate(0, ".concat(this.height-this.margin.top,")")).call(this.xAxis),svg.select(".axis-group .text.empty").style("opacity","rank"===this.type?1:0),this.animate?this.resetLinePath():(this.setShowDotsEnd(),this.updateAnimatePathLabel(this.xAxisEnd,0))},resetLinePath:function(){l.m(".line-path .line").each((function(){var select=l.l(this),t=select.node().getTotalLength();select.attr("stroke-dashoffset",t).attr("stroke-dasharray",t)}))},onClickChecks:function(){var t=l.l(".checks").attr("x"),e=this.xScaleActiveDate(t);e!==this.active&&(this.active=e,this.$emit("change",e))},onMouseHover:function(t){l.l(".checks").style("opacity",1),l.l(".tooltip-wrapper").style("opacity",1)},onMouseleave:function(){this.active?this.onMouseMove():(l.l(".checks").style("opacity",0),l.m(".mark-dots").style("opacity",0),l.l(".tooltip-wrapper").style("opacity",0))},onMouseMove:c.a.throttle((function(t){var e=this.active;if(t){var n=c.a.get(t,"x",0);e=this.xScaleActiveDate(n),this.hover=e}l.m(".mark-dots").style("opacity",0),l.m(".dots-".concat(e)).style("opacity",1),l.l(".checks").attr("x",this.xScale(e)),this.handleTooltip(e)}),100),handleTooltip:c.a.debounce((function(t){var e=this,title=this.dateDisplay(t),n="",r=this.engagement_raw_data.find((function(e){return e.date===t}))||{};"rank"===this.type&&(title="สัปดาห์ที่ ".concat(r.date),n="".concat(this.dateDisplay(r.date_from)," - ").concat(this.dateDisplay(r.date_to)));var o=c.a.chain(r).get("engagements",[]).map((function(t){var n="";return n="rank"===e.type?0===t.count?"ไม่มีข้อมูล":e.engagement_candidates.length+1-t.count:e.formatkilo(t.count),y(y({},t),{},{count_str:n})})).orderBy("count","desc").value(),d=l.l(".tooltip");d.select(".title").html(title),d.select(".description").html(n),o.forEach((function(t,i){var e=l.l(".content-".concat(i));e.select(".name").html(t.name),e.select(".value").html(t.count_str).style("color",t.color)}));var h=30+this.margin.left,f=this.xScale(t)-h,m=this.$refs.tooltip;if(m){var v=m.clientWidth;f=f-v<-20?h:f-v+this.margin.left,l.l(".tooltip-wrapper").style("left","".concat(f,"px"))}}),50),setAnimatePathLine:function(){var t=this;l.m(".line").each((function(){l.l(this).transition(t.transitionPath).attr("stroke-dashoffset",0)}))},clearAnimatePathLine:function(){l.m(".line").call((function(t){return t.transition()}))},setShowDotsEnd:function(){l.m("dots-".concat(this.xAxisEnd)).style("opacity",1)},updateAnimatePathLabel:function(t,e){var n=this,r=this,o=h()(t).diff(this.xAxisStart,"days"),line=l.f().x((function(t){return n.xScale(t.date)})).y((function(t){return n.yScale(t.count)})).defined((function(t,i){return i<=o&&i>=n.point||i<=n.point&&i>=o}));l.m(".line-path .line-seg").data(this.engagement_candidates).each((function(t){l.l(this).attr("d",line(t.data))}));l.m(".marker-group").data(this.engagement_candidates).each((function(n,i){var d=this,h=l.l("#line-seg-".concat(n.name));l.l(this).transition().duration(e).ease(l.c).attrTween("transform",o>r.point?r.translateRight(h.node()):r.translateLeft(h.node())).on("end",(function(){r.point=o,r.animate_finish=!0,function(select,e){var n=c.a.get(e,"data",[]).filter((function(e){return e.date===t})).find((function(t){return t.maximum.name===t.name}));select.select(".marker").transition().duration(250).attr("transform","scale(".concat(n?1.7:1,")"))}(l.l(d),n)}))}))},translateRight:function(t){var e=t.getTotalLength();return function(){return function(n){var p=t.getPointAtLength(n*e);return"translate("+p.x+","+p.y+")"}}},translateLeft:function(t){var e=t.getTotalLength();return function(){return function(n){var p=t.getPointAtLength((1-n)*e);return"translate("+p.x+","+p.y+")"}}},handleHover:function(t){l.l(t).moveToFront()},checksEvent:c.a.throttle((function(t){this.hover=t}),150),sumRangeTimeData:function(){var t=this,data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return data.filter((function(e){return t.handleCondition(e)})).reduce((function(t,e){return t+e.time}),0)}}},k=x,w=(n(505),n(47)),component=Object(w.a)(k,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"container",staticClass:"line-chart-race"},[n("div",{ref:"tooltip",staticClass:"tooltip-wrapper",staticStyle:{opacity:"0"}},[n("div",{staticClass:"tooltip typo-b5"},[n("div",{staticClass:"title mb-1"}),t._v(" "),n("div",{staticClass:"description typo-b6"}),t._v(" "),t._l(t.engagement_candidates,(function(e,r){return n("div",{key:(e||{}).candidate+"-"+r,class:"data-list content-"+r},[n("div",{staticClass:"name pr-4"}),t._v(" "),n("div",{staticClass:"value"})])}))],2)]),t._v(" "),n("svg",[n("g",{staticClass:"axis-group"},[n("text",{staticClass:"text empty",attrs:{y:t.innerHeight}},[n("tspan",{attrs:{dy:"1.2em",x:"0"}},[t._v("ไม่มี")]),t._v(" "),n("tspan",{attrs:{dy:"1.2em",x:"0"}},[t._v("ข้อมูล")])])]),t._v(" "),n("g",[n("rect",{staticClass:"checks",staticStyle:{transition:"'all 0.2s'"},attrs:{"stroke-width":"1px",width:".5px",height:t.height-t.margin.top-t.margin.bottom,y:t.margin.top,opacity:"0",stroke:"#e0e1e1"}})]),t._v(" "),0!=t.engagement_candidates?n("g",{staticClass:"g-lines"},t._l(t.engagement_candidates,(function(e){return n("g",{key:"line-"+(e.name||""),staticClass:"line-group"},[n("g",{staticClass:"circle"},[n("circle",{attrs:{fill:e.color,cx:t.margin.left,cy:t.yScale(e.data[0].count),r:"4"}}),t._v(" "),t._l(e.data,(function(r,o){return n("circle",{key:o,class:["dots-"+r.date,{"mark-dots":o!==e.data.length-1}],staticStyle:{opacity:"0"},attrs:{fill:e.color,cx:t.xScale(r.date),cy:t.yScale(r.count),r:"4"}})}))],2),t._v(" "),n("g",{staticClass:"line-path"},[n("path",{staticClass:"line",attrs:{d:t.line(e.data),fill:"none",stroke:e.color,"stroke-linejoin":"round","stroke-linecap":"round","stroke-width":"mobile"===t.$mq?2:4}}),t._v(" "),n("path",{staticClass:"line-seg",attrs:{id:"line-seg-"+e.name,d:t.line(e.data),fill:"none",stroke:"none","stroke-width":"2"}})])])})),0):t._e(),t._v(" "),n("g",{staticClass:"g-marker"},t._l(t.engagement_candidates,(function(e){return n("g",{key:"marker-"+e.name,staticClass:"marker-group",attrs:{transform:"translate("+t.xScale((e.data||{})[0].date)+","+t.yScale((e.data||{})[0].count)+")"}},[n("g",{staticClass:"marker",attrs:{transform:"scale(1)"}},[n("clipPath",{attrs:{id:"clip-"+e.name}},[n("use",{attrs:{"xlink:href":"#circle-"+e.name}})]),t._v(" "),n("circle",{staticClass:"circle",attrs:{id:"circle-"+e.name,r:"mobile"===t.$mq?6.5:12,fill:e.color,stroke:e.color,"stroke-width":4}}),t._v(" "),n("image",{staticClass:"image",attrs:{href:e.image,height:"mobile"===t.$mq?13:24,width:"mobile"===t.$mq?13:24,x:"mobile"===t.$mq?-6.5:-12,y:"mobile"===t.$mq?-6.5:-12,"clip-path":"url(#clip-"+e.name+")"}})])])})),0),t._v(" "),n("rect",{staticClass:"listening-rect",attrs:{width:t.innerWidth,height:t.innerHeight,x:t.margin.left,y:t.margin.top,fill:"transparent"},on:{mouseover:t.onMouseHover,mousemove:t.onMouseMove,mouseleave:t.onMouseleave,click:function(e){t.animate_finish&&"engagement"===t.type&&t.onClickChecks()}}})])])}),[],!1,null,"0b5e88d3",null);e.default=component.exports}}]);