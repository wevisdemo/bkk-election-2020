import{F as A,p as F,h as N,m as E,j as s,a as I,_ as v,D as h,y as P,b as p,P as y,E as w,S as O}from"./index.0c862dd9.js";import{D as L}from"./DistrictTooltip.21c0fc9c.js";const C=6;function _({district:r,isInProgress:l,isLive:n,onClick:x}){const i=A(F),a=N(null),[c,f]=E(!1);if(!i)return s(I,{});const[d,u]=E(!1),g=r.voting.progress||0,b=[{percent:g/100,color:"#FFFFFF",strip:n},{percent:1-g/100,color:"rgba(255, 255, 255, 0.2)"}],D=v(()=>{const e=r.voting.result.reduce((t,m)=>{if(!m.count||!r.voting.totalVotes)return t;const T=m.count/r.voting.totalVotes;return t.length==C?(t[t.length-1].percent+=T,t[t.length-1].color=h,t):[...t,{percent:T||0,color:i.candidateMap[m.candidateId].color,strip:n}]},[]);if(e.length==0)return[{percent:1,color:h,strip:n}];const o=e.reduce((t,m)=>t+m.percent,0);if(o!=1){const t=1-o;e[e.length-1].color.localeCompare(h)===0?e[e.length-1].percent+=t:e.push({percent:t,color:h,strip:n})}return e},[r]);return P(()=>{var e,o;a.current&&f(a.current.offsetTop-(((e=a.current.parentElement)==null?void 0:e.scrollTop)||0)<(((o=a.current.parentElement)==null?void 0:o.clientHeight)||0)/2)},[d]),p("div",{class:`grid ${n?"grid-cols-3 md:grid-cols-6":"grid-cols-2 md:grid-cols-5"} typo-u4 gap-x-4 gap-y-1 md:gap-8 hover:bg-white/20 items-center py-1`,onMouseOver:()=>u(!0),onMouseLeave:()=>u(!1),ref:a,onClick:x,children:[s("div",{class:"font-semibold",children:r.name}),p("div",{class:n?"text-left":"text-right md:text-left",children:[r.voting.eligiblePopulation.toLocaleString(),"\xA0(",(r.voting.eligiblePopulation/i.electionData.total.eligiblePopulation).toLocaleString(void 0,{style:"percent",minimumFractionDigits:1}),")"]}),p("div",{class:`${n?"col-span-3":"col-span-2 md:col-span-3"} relative flex h-full items-center order-last md:order-3`,children:[s("div",{className:"flex grow order-last md:order-3",children:s(y,{border:"1px solid #000000",className:"h-[10px]",progressItems:D})}),s(L,{show:d,district:r,className:`${c?"top-full":"bottom-full"}`,pointUp:c,topCandidateDisplay:C-1})]}),l&&n&&p("div",{class:"flex md:basis-2/12 gap-2 order-4",children:[g.toFixed(1),"%",s(y,{progressItems:b,className:"h-1 md:h-2"})]})]})}s("svg",{width:"10",height:"6",viewBox:"0 0 10 6",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:s("path",{d:"M1 1L5 5L9 1",stroke:"white"})});function M({onDistrictClick:r}){const l=A(F),[n,x]=E(!1);if(!l)return s(I,{});const[i,a]=E("name"),[c,f]=E(!1),d=[{text:"\u0E40\u0E02\u0E15",className:"cursor-pointer",sortType:"name"},{text:"\u0E1C\u0E39\u0E49\u0E21\u0E35\u0E2A\u0E34\u0E17\u0E18\u0E34\u0E4C\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E15\u0E31\u0E49\u0E07",className:"cursor-pointer whitespace-nowrap"+(l.electionData.total.progress?"":" text-right md:text-left"),sortType:"eligible"},{text:"\u0E1C\u0E25\u0E01\u0E32\u0E23\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E15\u0E31\u0E49\u0E07",className:"col-span-3 grow hidden md:flex",children:""},{text:"\u0E19\u0E31\u0E1A\u0E04\u0E30\u0E41\u0E19\u0E19\u0E41\u0E25\u0E49\u0E27",className:"cursor-pointer whitespace-nowrap text-right",sortType:"percent"}];l.electionData.type!==w.Live&&d.pop();const u=v(()=>c?-1:1,[c]),g=e=>e==="eligible"||e==="percent",b=v(()=>{const e=l.electionData.districts;switch(i){case"eligible":return e.sort((o,t)=>(o.voting.eligiblePopulation-t.voting.eligiblePopulation)*u);case"percent":return e.sort((o,t)=>((o.voting.progress||100)-(t.voting.progress||100))*u);case"name":default:return e.sort((o,t)=>o.name.localeCompare(t.name)*u)}},[l,i,u]),D=e=>{e&&(e===i?f(!c):(a(e),f(g(e))))};return p("div",{class:"flex flex-col flex-1 relative overflow-y-hidden",children:[s("div",{class:`grid ${l.electionData.type===w.Live?"grid-cols-3 md:grid-cols-6":"grid-cols-2 md:grid-cols-5"} typo-u4 gap-4 gap-y-1 md:gap-8 border-b border-white/40 pb-1`,children:d.map(e=>s(O,{headerText:e.text,className:e.className,isActive:e.sortType===i,descending:c,headerOnClick:()=>D(e.sortType),children:e.children}))}),p("div",{class:"flex flex-col pt-2 gap-2 overflow-y-auto hide-scrollbar",onScroll:e=>{const o=e.target;x(o.scrollHeight-o.scrollTop-o.clientHeight<1)},children:[s("div",{class:`absolute w-full h-11 bg-gradient-to-t z-[5] from-black to-black/0 bottom-0 pointer-events-none ${n&&"hidden"}`}),b.map((e,o)=>s(_,{district:e,isInProgress:l.electionData.total.progress!==void 0,isLive:l.electionData.type===w.Live,onClick:()=>r(e)}))]})]})}export{M as default};
